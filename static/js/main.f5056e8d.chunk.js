(this["webpackJsonpsocket-chat-front"]=this["webpackJsonpsocket-chat-front"]||[]).push([[0],{48:function(e,t,n){},49:function(e,t,n){},72:function(e,t){},80:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n(0),r=n.n(s),i=n(13),o=n.n(i),a=(n(48),n(8)),u=(n(49),n(26)),l=n(2),d=n(40),j=n.n(d),b={socket:null,createConnection:function(){this.socket=j()("http://samurai-chat-back.herokuapp.com/")},subscribe:function(e,t,n){var c,s,r;null===(c=this.socket)||void 0===c||c.on("init-messages-published",e),null===(s=this.socket)||void 0===s||s.on("new-message-sent",t),null===(r=this.socket)||void 0===r||r.on("user-typing",n)},sendName:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-name-sent",e)},sendMessage:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-message-sent",e,(function(e){e&&alert(e)}))},typeMessage:function(){var e;null===(e=this.socket)||void 0===e||e.emit("client-typed")},destroyConnection:function(){var e;null===(e=this.socket)||void 0===e||e.disconnect(),this.socket=null}},f={messages:[],typingUsers:[]},h=n(6);var g=function(){var e=Object(h.c)((function(e){return e.chat.messages})),t=Object(h.c)((function(e){return e.chat.typingUsers})),n=Object(h.b)();Object(s.useEffect)((function(){return n((function(e){b.createConnection(),b.subscribe((function(t,n){e(function(e){return{type:"messages-received",messages:e}}(t)),n()}),(function(t){e(function(e){return{type:"new-message-received",message:e}}(t))}),(function(t){e(function(e){return{type:"typingUserAdded",user:e}}(t))}))})),function(){n((function(e){b.destroyConnection()}))}}),[]),Object(s.useEffect)((function(){var e;O&&(null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[e]);var r=Object(s.useState)("test"),i=Object(a.a)(r,2),o=i[0],u=i[1],l=Object(s.useState)(""),d=Object(a.a)(l,2),j=d[0],f=d[1],g=Object(s.useState)(!0),v=Object(a.a)(g,2),O=v[0],m=v[1],p=Object(s.useState)(0),x=Object(a.a)(p,2),y=x[0],k=x[1],w=Object(s.useRef)(null);return Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{style:{border:"1px solid black",padding:"10px",height:"300px",width:"300px",overflowY:"scroll"},onScroll:function(e){return function(e){var t=e.currentTarget.scrollHeight-e.currentTarget.clientHeight;e.currentTarget.scrollTop>y&&Math.abs(t-e.currentTarget.scrollTop)<10?m(!0):m(!1),k(e.currentTarget.scrollTop)}(e)},children:[e.map((function(e){return Object(c.jsxs)("div",{children:[Object(c.jsxs)("b",{children:[e.user.name,": "]})," ",e.message,Object(c.jsx)("hr",{})]},e.id)})),t.map((function(e){return Object(c.jsxs)("div",{children:[Object(c.jsxs)("i",{children:[e.name,": "]})," ..."]},e.id)})),Object(c.jsx)("div",{ref:w,children:" "})]}),Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{value:j,onChange:function(e){return f(e.currentTarget.value)}}),Object(c.jsx)("button",{onClick:function(){n(function(e){return function(t){b.sendName(e)}}(j))},children:"send name"})]}),Object(c.jsx)("textarea",{value:o,onKeyPress:function(){n((function(e){b.typeMessage()}))},onChange:function(e){return u(e.currentTarget.value)}}),Object(c.jsx)("button",{onClick:function(){n(function(e){return function(t){b.sendMessage(e)}}(o)),u("")},children:"send"})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var v=n(5),O=n(42),m=Object(v.c)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"messages-received":return Object(l.a)(Object(l.a)({},e),{},{messages:t.messages});case"new-message-received":return Object(l.a)(Object(l.a)({},e),{},{messages:[].concat(Object(u.a)(e.messages),[t.message]),typingUsers:e.typingUsers.filter((function(e){return e.id!==t.message.user.id}))});case"typingUserAdded":return Object(l.a)(Object(l.a)({},e),{},{typingUsers:[].concat(Object(u.a)(e.typingUsers.filter((function(e){return e.id!==t.user.id}))),[t.user])});default:return e}}}),p=Object(v.d)(m,Object(v.a)(O.a));o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(h.a,{store:p,children:Object(c.jsx)(g,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[80,1,2]]]);
//# sourceMappingURL=main.f5056e8d.chunk.js.map